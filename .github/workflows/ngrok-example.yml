name: '[ç¯„ä¾‹] ä½¿ç”¨ NGROK çš„äº’å‹•å¼è¼¸å…¥ï¼ˆå¯é¸æ¨¡å¼ï¼‰'

on:
  workflow_dispatch:

jobs:
  interactive-inputs:
    timeout-minutes: 10
    runs-on: ubuntu-latest
    permissions:
      contents: write
      actions: write
    steps:
      - name: äº’å‹•å¼è¼¸å…¥æ­¥é©Ÿï¼ˆä½¿ç”¨ NGROKï¼‰
        id: interactive-inputs
        uses: boasihq/interactive-inputs@v2
        with:
          use-network-ip: false  # æ˜ç¢ºç¦ç”¨ç¶²è·¯ IP æ¨¡å¼
          ngrok-authtoken: ${{ secrets.NGROK_AUTHTOKEN }}  # éœ€è¦ NGROK token
          notifier-slack-enabled: "false"
          notifier-discord-enabled: "false"
          timeout: 300
          title: 'ğŸŒ ä½¿ç”¨ NGROK çš„äº’å‹•å¼è¼¸å…¥ç¯„ä¾‹'
          interactive: |
            fields:
              - label: æ¦‚è¿°
                properties:
                  type: textarea
                  description: æ­¤ç¯„ä¾‹å±•ç¤ºå¦‚ä½•ä½¿ç”¨ NGROK æ¨¡å¼
                  defaultValue: "é€™æ˜¯ä¸€å€‹ä½¿ç”¨ NGROK çš„äº’å‹•å¼è¼¸å…¥ç¯„ä¾‹ã€‚NGROK æ¨¡å¼æä¾›å¤–éƒ¨ç¶²è·¯å­˜å–ï¼Œé©åˆéœ€è¦å¾ç¶²éš›ç¶²è·¯è¨ªå•çš„å ´æ™¯ã€‚\n\næ³¨æ„ï¼šç¾åœ¨ç¶²è·¯ IP æ˜¯é è¨­æ¨¡å¼ï¼ŒNGROK è®Šç‚ºå¯é¸æ¨¡å¼ã€‚"
                  readOnly: true
              - label: ä½¿ç”¨è€…å§“å
                properties:
                  display: è«‹è¼¸å…¥æ‚¨çš„å§“å
                  type: text
                  description: æ‚¨çš„å®Œæ•´å§“å
                  maxLength: 50
                  required: true
                  placeholder: ä¾‹å¦‚ï¼šå¼µä¸‰
              - label: é›»å­éƒµä»¶
                properties:
                  display: é›»å­éƒµä»¶åœ°å€
                  type: text
                  description: ç”¨æ–¼æ¥æ”¶é€šçŸ¥çš„é›»å­éƒµä»¶
                  required: true
                  placeholder: example@company.com
              - label: å­˜å–æ–¹å¼
                properties:
                  display: é¸æ“‡å­˜å–æ–¹å¼
                  type: select
                  description: æ‚¨åå¥½çš„å­˜å–æ–¹å¼
                  choices:
                    - å…§éƒ¨ç¶²è·¯å­˜å–ï¼ˆç¶²è·¯ IPï¼‰
                    - å¤–éƒ¨ç¶²è·¯å­˜å–ï¼ˆNGROKï¼‰
                    - å…©è€…éƒ½å¯ä»¥
                  required: true
              - label: ä½¿ç”¨å ´æ™¯
                properties:
                  display: é¸æ“‡ä½¿ç”¨å ´æ™¯ï¼ˆå¯å¤šé¸ï¼‰
                  type: multiselect
                  description: æ­¤äº’å‹•å¼è¼¸å…¥çš„ä½¿ç”¨å ´æ™¯
                  choices: 
                    ["å…§éƒ¨æ¸¬è©¦", "å¤–éƒ¨å±•ç¤º", "å®¢æˆ¶æ¼”ç¤º", "é ç«¯å”ä½œ", "CI/CD æµç¨‹", "é–‹ç™¼æ¸¬è©¦"]
                  required: true
              - label: å®‰å…¨ç­‰ç´š
                properties:
                  display: å®‰å…¨ç­‰ç´šè¦æ±‚
                  type: select
                  description: è³‡æ–™çš„å®‰å…¨ç­‰ç´šè¦æ±‚
                  choices:
                    - ä½ï¼ˆå…¬é–‹è³‡æ–™ï¼‰
                    - ä¸­ï¼ˆå…§éƒ¨è³‡æ–™ï¼‰
                    - é«˜ï¼ˆæ©Ÿå¯†è³‡æ–™ï¼‰
                    - æœ€é«˜ï¼ˆæ¥µæ©Ÿå¯†è³‡æ–™ï¼‰
                  required: true
              - label: æ˜¯å¦éœ€è¦å¤–éƒ¨å­˜å–
                properties:
                  display: æ˜¯å¦éœ€è¦å¤–éƒ¨ç¶²è·¯å­˜å–ï¼Ÿ
                  type: boolean
                  description: æ­¤äº’å‹•å¼è¼¸å…¥æ˜¯å¦éœ€è¦å¾ç¶²éš›ç¶²è·¯è¨ªå•
                  defaultValue: 'true'
                  required: true
              - label: å‚™è¨»
                properties:
                  display: é¡å¤–å‚™è¨»
                  type: textarea
                  description: ä»»ä½•é¡å¤–çš„èªªæ˜æˆ–éœ€æ±‚
                  maxLength: 500
                  placeholder: è«‹è¼¸å…¥ä»»ä½•é¡å¤–çš„èªªæ˜...

      - name: é¡¯ç¤ºè¼¸å‡ºçµæœ
        shell: bash
        run: |
          echo "ğŸ‰ äº’å‹•å¼è¼¸å…¥å®Œæˆï¼"
          echo -e "\n==============================\n"
          echo "ğŸ“‹ æ”¶é›†åˆ°çš„è³‡è¨Šï¼š"
          echo "å§“å: ${{ steps.interactive-inputs.outputs.ä½¿ç”¨è€…å§“å }}"
          echo "é›»å­éƒµä»¶: ${{ steps.interactive-inputs.outputs.é›»å­éƒµä»¶ }}"
          echo "å­˜å–æ–¹å¼: ${{ steps.interactive-inputs.outputs.å­˜å–æ–¹å¼ }}"
          echo "ä½¿ç”¨å ´æ™¯: ${{ join(steps.interactive-inputs.outputs.ä½¿ç”¨å ´æ™¯, ', ') }}"
          echo "å®‰å…¨ç­‰ç´š: ${{ steps.interactive-inputs.outputs.å®‰å…¨ç­‰ç´š }}"
          echo "éœ€è¦å¤–éƒ¨å­˜å–: ${{ steps.interactive-inputs.outputs.æ˜¯å¦éœ€è¦å¤–éƒ¨å­˜å– }}"
          echo -e "\n==============================\n"
          echo "ğŸ“„ å‚™è¨»ï¼š"
          echo "${{ steps.interactive-inputs.outputs.å‚™è¨» }}"
          echo -e "\n==============================\n"

      - name: æ ¹æ“šå­˜å–æ–¹å¼åŸ·è¡Œå¾ŒçºŒæµç¨‹
        run: |
          echo "ğŸ”§ æ ¹æ“šé¸æ“‡çš„å­˜å–æ–¹å¼åŸ·è¡Œå¾ŒçºŒæµç¨‹..."
          
          case "${{ steps.interactive-inputs.outputs.å­˜å–æ–¹å¼ }}" in
            "å…§éƒ¨ç¶²è·¯å­˜å–ï¼ˆç¶²è·¯ IPï¼‰")
              echo "ğŸ  ä½¿ç”¨å…§éƒ¨ç¶²è·¯å­˜å–æ¨¡å¼"
              echo "å»ºè­°ï¼šä½¿ç”¨é è¨­çš„ç¶²è·¯ IP æ¨¡å¼ï¼Œç„¡éœ€é¡å¤–è¨­å®š"
              ;;
            "å¤–éƒ¨ç¶²è·¯å­˜å–ï¼ˆNGROKï¼‰")
              echo "ğŸŒ ä½¿ç”¨å¤–éƒ¨ç¶²è·¯å­˜å–æ¨¡å¼"
              echo "å»ºè­°ï¼šä½¿ç”¨ NGROK æ¨¡å¼ï¼Œéœ€è¦è¨­å®š NGROK token"
              ;;
            "å…©è€…éƒ½å¯ä»¥")
              echo "ğŸ”„ æ”¯æ´å…©ç¨®å­˜å–æ¨¡å¼"
              echo "å»ºè­°ï¼šæ ¹æ“šå¯¦éš›éœ€æ±‚é¸æ“‡åˆé©çš„æ¨¡å¼"
              ;;
          esac
          
          # æ ¹æ“šå®‰å…¨ç­‰ç´šèª¿æ•´è™•ç†æ–¹å¼
          case "${{ steps.interactive-inputs.outputs.å®‰å…¨ç­‰ç´š }}" in
            "ä½ï¼ˆå…¬é–‹è³‡æ–™ï¼‰")
              echo "ğŸŸ¢ ä½å®‰å…¨ç­‰ç´šï¼šä½¿ç”¨æ¨™æº–è™•ç†æµç¨‹"
              ;;
            "ä¸­ï¼ˆå…§éƒ¨è³‡æ–™ï¼‰")
              echo "ğŸŸ¡ ä¸­å®‰å…¨ç­‰ç´šï¼šåŠ å¼·è³‡æ–™ä¿è­·"
              ;;
            "é«˜ï¼ˆæ©Ÿå¯†è³‡æ–™ï¼‰")
              echo "ğŸŸ  é«˜å®‰å…¨ç­‰ç´šï¼šä½¿ç”¨åŠ å¯†å’Œåš´æ ¼å­˜å–æ§åˆ¶"
              ;;
            "æœ€é«˜ï¼ˆæ¥µæ©Ÿå¯†è³‡æ–™ï¼‰")
              echo "ğŸ”´ æœ€é«˜å®‰å…¨ç­‰ç´šï¼šä½¿ç”¨æœ€é«˜ç´šåˆ¥çš„è³‡æ–™ä¿è­·æªæ–½"
              ;;
          esac

      - name: æ¨¡å¼å»ºè­°
        run: |
          echo "ğŸ’¡ æ¨¡å¼ä½¿ç”¨å»ºè­°ï¼š"
          echo -e "\n==============================\n"
          echo "ğŸŒ ç¶²è·¯ IP æ¨¡å¼ï¼ˆé è¨­ï¼‰ï¼š"
          echo "  âœ… é©åˆå…§éƒ¨ç¶²è·¯ç’°å¢ƒ"
          echo "  âœ… ç„¡éœ€å¤–éƒ¨æœå‹™ä¾è³´"
          echo "  âœ… è¨­å®šç°¡å–®å¿«é€Ÿ"
          echo "  âŒ éœ€è¦ç¶²è·¯é€£é€šæ€§"
          echo ""
          echo "ğŸ”— NGROK æ¨¡å¼ï¼ˆå¯é¸ï¼‰ï¼š"
          echo "  âœ… æ”¯æ´å¤–éƒ¨ç¶²è·¯å­˜å–"
          echo "  âœ… é©åˆé ç«¯å”ä½œ"
          echo "  âœ… ç„¡éœ€ç¶²è·¯è¨­å®š"
          echo "  âŒ éœ€è¦ NGROK å¸³æˆ¶"
          echo "  âŒ ä¾è³´å¤–éƒ¨æœå‹™"
          echo -e "\n==============================\n"
