name: '[ç¯„ä¾‹] Port ç®¡ç†åŠŸèƒ½å±•ç¤º'

on:
  workflow_dispatch:

jobs:
  port-management-demo:
    timeout-minutes: 10
    runs-on: ubuntu-latest
    permissions:
      contents: write
      actions: write
    steps:
      - name: å±•ç¤º Port è‡ªå‹•éå¢åŠŸèƒ½
        id: interactive-inputs
        uses: boasihq/interactive-inputs@v2
        with:
          # use-network-ip: true  # ç¾åœ¨æ˜¯é è¨­å€¼
          start-port: "8080"  # å¾ port 8080 é–‹å§‹ï¼Œå¦‚æœè¢«å ç”¨æœƒè‡ªå‹•éå¢
          notifier-slack-enabled: "false"
          notifier-discord-enabled: "false"
          timeout: 300
          title: 'ğŸ”§ Port ç®¡ç†åŠŸèƒ½å±•ç¤º'
          interactive: |
            fields:
              - label: æ¦‚è¿°
                properties:
                  type: textarea
                  description: Port ç®¡ç†åŠŸèƒ½èªªæ˜
                  defaultValue: "æ­¤ç¯„ä¾‹å±•ç¤º Port è‡ªå‹•ç®¡ç†åŠŸèƒ½ï¼š\n\n1. é è¨­å¾ port 8080 é–‹å§‹\n2. å¦‚æœ port è¢«å ç”¨ï¼Œæœƒè‡ªå‹•å˜—è©¦ 8081, 8082, 8083...\n3. æœ€å¤šå˜—è©¦ 100 å€‹ port\n4. æœƒé¡¯ç¤ºå¯¦éš›ä½¿ç”¨çš„ port è™Ÿç¢¼\n5. æ”¯æ´è‡ªè¨‚èµ·å§‹ port"
                  readOnly: true
              - label: æ¸¬è©¦åç¨±
                properties:
                  display: è«‹è¼¸å…¥æ¸¬è©¦åç¨±
                  type: text
                  description: ç”¨æ–¼è­˜åˆ¥æ­¤æ¸¬è©¦çš„åç¨±
                  maxLength: 50
                  required: true
                  placeholder: ä¾‹å¦‚ï¼šPort æ¸¬è©¦ 001
              - label: é æœŸ Port
                properties:
                  display: é æœŸçš„èµ·å§‹ Port
                  type: number
                  description: æ‚¨é æœŸä½¿ç”¨çš„èµ·å§‹ port è™Ÿç¢¼
                  minNumber: 1
                  maxNumber: 65535
                  placeholder: 8080
                  required: true
              - label: æ¸¬è©¦é¡å‹
                properties:
                  display: é¸æ“‡æ¸¬è©¦é¡å‹
                  type: select
                  description: è¦åŸ·è¡Œçš„æ¸¬è©¦é¡å‹
                  choices:
                    - åŸºæœ¬ Port æ¸¬è©¦
                    - Port è¡çªæ¸¬è©¦
                    - è‡ªè¨‚ Port æ¸¬è©¦
                    - å£“åŠ›æ¸¬è©¦
                  required: true
              - label: æ¸¬è©¦ç’°å¢ƒ
                properties:
                  display: é¸æ“‡æ¸¬è©¦ç’°å¢ƒ
                  type: multiselect
                  description: è¦æ¸¬è©¦çš„ç’°å¢ƒï¼ˆå¯å¤šé¸ï¼‰
                  choices: 
                    ["é–‹ç™¼ç’°å¢ƒ", "æ¸¬è©¦ç’°å¢ƒ", "é ç™¼å¸ƒç’°å¢ƒ", "ç”Ÿç”¢ç’°å¢ƒ"]
                  required: true
              - label: æ¸¬è©¦æŒçºŒæ™‚é–“
                properties:
                  display: æ¸¬è©¦æŒçºŒæ™‚é–“ï¼ˆåˆ†é˜ï¼‰
                  type: number
                  description: æ¸¬è©¦æ‡‰è©²æŒçºŒå¤šé•·æ™‚é–“
                  minNumber: 1
                  maxNumber: 60
                  placeholder: 5
                  required: true
              - label: æ˜¯å¦è¨˜éŒ„è©³ç´°æ—¥èªŒ
                properties:
                  display: æ˜¯å¦è¨˜éŒ„è©³ç´°æ—¥èªŒï¼Ÿ
                  type: boolean
                  description: å•Ÿç”¨è©³ç´°çš„ port åµæ¸¬æ—¥èªŒ
                  defaultValue: 'true'
                  required: true
              - label: æ¸¬è©¦å‚™è¨»
                properties:
                  display: æ¸¬è©¦å‚™è¨»
                  type: textarea
                  description: ä»»ä½•é¡å¤–çš„æ¸¬è©¦èªªæ˜æˆ–å‚™è¨»
                  maxLength: 500
                  placeholder: è«‹è¼¸å…¥æ¸¬è©¦ç›¸é—œçš„å‚™è¨»...

      - name: é¡¯ç¤º Port è³‡è¨Š
        shell: bash
        run: |
          echo "ğŸ¯ Port ç®¡ç†æ¸¬è©¦å®Œæˆï¼"
          echo -e "\n==============================\n"
          echo "ğŸ“‹ æ¸¬è©¦è³‡è¨Šï¼š"
          echo "æ¸¬è©¦åç¨±: ${{ steps.interactive-inputs.outputs.æ¸¬è©¦åç¨± }}"
          echo "é æœŸ Port: ${{ steps.interactive-inputs.outputs.é æœŸ_Port }}"
          echo "æ¸¬è©¦é¡å‹: ${{ steps.interactive-inputs.outputs.æ¸¬è©¦é¡å‹ }}"
          echo "æ¸¬è©¦ç’°å¢ƒ: ${{ join(steps.interactive-inputs.outputs.æ¸¬è©¦ç’°å¢ƒ, ', ') }}"
          echo "æ¸¬è©¦æŒçºŒæ™‚é–“: ${{ steps.interactive-inputs.outputs.æ¸¬è©¦æŒçºŒæ™‚é–“ }} åˆ†é˜"
          echo "è©³ç´°æ—¥èªŒ: ${{ steps.interactive-inputs.outputs.æ˜¯å¦è¨˜éŒ„è©³ç´°æ—¥èªŒ }}"
          echo -e "\n==============================\n"
          echo "ğŸ“„ æ¸¬è©¦å‚™è¨»ï¼š"
          echo "${{ steps.interactive-inputs.outputs.æ¸¬è©¦å‚™è¨» }}"
          echo -e "\n==============================\n"

      - name: æ¨¡æ“¬ Port è¡çªæ¸¬è©¦
        if: steps.interactive-inputs.outputs.æ¸¬è©¦é¡å‹ == 'Port è¡çªæ¸¬è©¦'
        shell: bash
        run: |
          echo "ğŸ” åŸ·è¡Œ Port è¡çªæ¸¬è©¦..."
          echo "æ­¤æ¸¬è©¦æœƒæ¨¡æ“¬ port è¢«å ç”¨çš„æƒ…æ³"
          echo "Action æœƒè‡ªå‹•å°‹æ‰¾ä¸‹ä¸€å€‹å¯ç”¨çš„ port"
          echo "å¯¦éš›ä½¿ç”¨çš„ port æœƒåœ¨æ—¥èªŒä¸­é¡¯ç¤º"

      - name: åŸ·è¡Œè‡ªè¨‚ Port æ¸¬è©¦
        if: steps.interactive-inputs.outputs.æ¸¬è©¦é¡å‹ == 'è‡ªè¨‚ Port æ¸¬è©¦'
        shell: bash
        run: |
          echo "âš™ï¸ åŸ·è¡Œè‡ªè¨‚ Port æ¸¬è©¦..."
          echo "èµ·å§‹ Port: ${{ steps.interactive-inputs.outputs.é æœŸ_Port }}"
          echo "å¦‚æœè©² port è¢«å ç”¨ï¼Œæœƒè‡ªå‹•éå¢å°‹æ‰¾å¯ç”¨ port"

      - name: åŸ·è¡Œå£“åŠ›æ¸¬è©¦
        if: steps.interactive-inputs.outputs.æ¸¬è©¦é¡å‹ == 'å£“åŠ›æ¸¬è©¦'
        shell: bash
        run: |
          echo "ğŸ’ª åŸ·è¡Œå£“åŠ›æ¸¬è©¦..."
          echo "æ¸¬è©¦ Port ç®¡ç†åœ¨é«˜è² è¼‰ä¸‹çš„è¡¨ç¾"
          echo "æŒçºŒæ™‚é–“: ${{ steps.interactive-inputs.outputs.æ¸¬è©¦æŒçºŒæ™‚é–“ }} åˆ†é˜"

      - name: æ¸¬è©¦å®Œæˆé€šçŸ¥
        shell: bash
        run: |
          echo "âœ… Port ç®¡ç†åŠŸèƒ½æ¸¬è©¦å®Œæˆï¼"
          echo "ğŸ“Š æ¸¬è©¦çµæœå·²è¨˜éŒ„"
          echo "ğŸ”§ Port è‡ªå‹•éå¢åŠŸèƒ½é‹ä½œæ­£å¸¸"
